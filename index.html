<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>그노시아 시뮬레이터</title>

  <!-- 카페24 고운밤 (Cafe24Oneprettynight) 웹폰트: Noonnu CDN -->
  <style>
    @font-face {
      font-family: 'Cafe24Oneprettynight';
      src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_twelve@1.1/Cafe24Oneprettynight.woff') format('woff');
      font-weight: normal;
      font-style: normal;
    }
  </style>

  <link rel="stylesheet" href="./style.css" />

  <!-- ✅ style.css가 덮어써도 폰트/표시가 무조건 적용되도록 HTML에서 강제 오버라이드 -->
  <style>
    body, input, select, button, textarea {
      font-family: 'Cafe24Oneprettynight', system-ui, sans-serif !important;
    }

    /* ✅ “안 보인다” 이슈의 흔한 원인(overflow/height 0/opacity 0 등)을 방지 */
    #statsGrid, #statusGrid,
    #persGrid, #personalityGrid,
    #commandList, #commandsGrid {
      display: grid;
      visibility: visible !important;
      opacity: 1 !important;
      max-height: none !important;
      height: auto !important;
      overflow: visible !important;
      min-height: 10px;
    }

    /* ✅ 커맨드가 ‘…’으로 줄어드는 문제 방지 */
    .cmd-grid, .cmd-grid * {
      white-space: normal !important;
      overflow: visible !important;
      text-overflow: clip !important;
      word-break: keep-all;
    }
  </style>
</head>

<body>
  <header class="topbar">
    <div class="brand">
      <div class="title">그노시아 시뮬레이터</div>
      <div class="subtitle">팬메이드 시뮬레이터 (로컬 실행 / GitHub Pages)</div>
    </div>

    <div class="top-actions">
      <button id="runBtn" class="btn primary" disabled>실행(1스텝)</button>
      <button id="logSaveBtn" class="btn">로그 저장</button>
    </div>
  </header>

  <main class="layout">
    <!-- LEFT: 명단 관리 -->
    <section class="panel">
      <div class="panel-head">
        <h2>명단 관리</h2>
        <div class="hint">캐릭터 5~15명 필요</div>
      </div>

      <div id="editBanner" class="banner" style="display:none;">
        <b>수정 모드</b> — 아래 내용을 고치고 “수정 적용”을 누르세요.
      </div>

      <div class="grid2">
        <label class="field">
          <span class="label">이름</span>
          <input id="name" class="input" placeholder="이름" />
        </label>

        <label class="field">
          <span class="label">성별</span>
          <select id="gender" class="input">
            <option value="남성">남성</option>
            <option value="여성">여성</option>
            <option value="범성">범성</option>
          </select>
        </label>

        <label class="field">
          <span class="label">식별연령</span>
          <input id="age" class="input" type="number" min="0" step="1" placeholder="0 이상" />
        </label>

        <div class="field">
          <span class="label">세이브/로드(캐릭터만)</span>
          <div class="row-inline">
            <button id="saveBtn" class="btn">세이브</button>
            <input id="loadFile" class="input file" type="file" accept="application/json" />
            <button id="loadBtn" class="btn">로드</button>
          </div>
        </div>
      </div>

      <div class="two-columns">
        <div class="box">
          <div class="box-head">
            <h3>스테이터스 (0~50)</h3>
            <div class="mini">소수 1자리 가능</div>
          </div>

          <!-- ✅ main.js가 어느 id를 찾든 채워지도록 “호환용 컨테이너 2개” 제공 -->
          <div id="statsGrid" class="kv-grid"></div>
          <div id="statusGrid" class="kv-grid"></div>
        </div>

        <div class="box">
          <div class="box-head">
            <h3>성격 (0.00~1.00)</h3>
            <div class="mini">소수 2자리 권장</div>
          </div>

          <!-- ✅ 호환용 컨테이너 2개 -->
          <div id="persGrid" class="kv-grid"></div>
          <div id="personalityGrid" class="kv-grid"></div>
        </div>
      </div>

      <details class="box" open>
        <summary class="summary">
          <h3>사용 가능 커맨드 체크</h3>
          <span class="mini">체크한 커맨드만 캐릭터가 사용</span>
        </summary>

        <!-- ✅ 호환용 컨테이너 2개 -->
        <div id="commandList" class="cmd-grid"></div>
        <div id="commandsGrid" class="cmd-grid"></div>
      </details>

      <div class="row-inline">
        <button id="addChar" class="btn primary">캐릭터 추가</button>
        <button id="applyEditBtn" class="btn" disabled>수정 적용</button>
        <button id="cancelEditBtn" class="btn" disabled>수정 취소</button>
      </div>

      <div class="divider"></div>

      <h3 class="subhead">캐릭터 목록</h3>
      <div id="charList" class="list"></div>
    </section>

    <!-- RIGHT: 게임 설정 / 관계도 / 로그 -->
    <section class="panel">
      <div class="panel-head">
        <h2>게임 설정</h2>
        <div class="hint">역할 포함/제외 + 그노시아 수</div>
      </div>

      <div class="settings">
        <div class="settings-grid">
          <label class="toggle">
            <input type="checkbox" id="setEngineer" checked />
            <span>엔지니어</span>
          </label>
          <label class="toggle">
            <input type="checkbox" id="setDoctor" checked />
            <span>닥터</span>
          </label>
          <label class="toggle">
            <input type="checkbox" id="setGuardian" checked />
            <span>수호천사</span>
          </label>
          <label class="toggle">
            <input type="checkbox" id="setGuardDuty" checked />
            <span>선내대기인</span>
          </label>
          <label class="toggle">
            <input type="checkbox" id="setAC" checked />
            <span>AC주의자</span>
          </label>
          <label class="toggle">
            <input type="checkbox" id="setBug" checked />
            <span>버그</span>
          </label>
        </div>

        <div class="row-inline">
          <label class="field grow">
            <span class="label">그노시아 수</span>
            <input id="gnosiaCount" class="input" type="number" min="1" max="6" value="1" />
          </label>
          <div class="mini note">
            ※ 인원수에 따라 최대치 자동 제한(엔진에서 처리)
          </div>
        </div>
      </div>

      <div class="divider"></div>

      <div class="panel-head">
        <h2>관계도</h2>
        <div class="hint">신뢰/우호 시각화</div>
      </div>

      <div class="relations">
        <div id="relationsView" class="relations-box">
          관계도 준비 중…
        </div>
      </div>

      <div class="divider"></div>

      <div class="panel-head">
        <h2>로그</h2>
        <div class="hint">실행 버튼 1번 = 1스텝</div>
      </div>

      <div id="log" class="log"></div>
    </section>
  </main>

  <script type="module" src="./main.js"></script>
</body>
</html>
