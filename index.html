<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>Gnosia Simulator</title>
  <style>
    body {
      background: #111;
      color: #eee;
      font-family: monospace;
      margin: 0;
      padding: 20px;
    }
    h1,h2 { margin: 10px 0; }
    .container {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
    }
    .panel {
      background: #1a1a1a;
      padding: 15px;
      border: 1px solid #444;
      border-radius: 5px;
      flex: 1 1 300px;
      box-sizing: border-box;
    }
    label {
      display: flex;
      justify-content: space-between;
      margin: 4px 0;
    }
    input, select, button {
      padding: 4px;
      margin-left: 5px;
      background: #222;
      border: 1px solid #555;
      color: #eee;
      width: 60px;
    }
    fieldset {
      margin-top: 10px;
      padding: 10px;
      border: 1px solid #444;
    }
    #charList {
      list-style: none;
      padding-left: 0;
      max-height: 400px;
      overflow-y: auto;
    }
    #log {
      border: 1px solid #444;
      height: 400px;
      overflow-y: auto;
      padding: 5px;
      background: #000;
      white-space: pre-wrap;
    }
    button { width: 100%; margin-top: 5px; }
  </style>
</head>
<body>

<h1>그노시아 시뮬레이터</h1>

<div class="container">
  <div class="panel">
    <h2>캐릭터 생성</h2>
    <label>이름 <input id="name" placeholder="이름"></label>
    <label>성별 
      <select id="gender">
        <option value="남성">남성</option>
        <option value="여성">여성</option>
        <option value="범성">범성</option>
      </select>
    </label>
    <label>나이 <input id="age" type="number" min="0" placeholder="나이"></label>

    <fieldset>
      <legend>스테이터스 (0~50)</legend>
      <label>카리스마 <input id="charisma" type="number" min="0" max="50"></label>
      <label>논리력 <input id="logic" type="number" min="0" max="50"></label>
      <label>연기력 <input id="acting" type="number" min="0" max="50"></label>
      <label>귀염성 <input id="charm" type="number" min="0" max="50"></label>
      <label>스텔스 <input id="stealth" type="number" min="0" max="50"></label>
      <label>직감 <input id="intuition" type="number" min="0" max="50"></label>
    </fieldset>

    <fieldset>
      <legend>성격 (0.00~1.00)</legend>
      <label>쾌활함 <input id="cheer" type="number" min="0" max="1" step="0.01"></label>
      <label>사회성 <input id="social" type="number" min="0" max="1" step="0.01"></label>
      <label>논리성향 <input id="logical" type="number" min="0" max="1" step="0.01"></label>
      <label>상냥함 <input id="kindness" type="number" min="0" max="1" step="0.01"></label>
      <label>욕망 <input id="desire" type="number" min="0" max="1" step="0.01"></label>
      <label>용기 <input id="courage" type="number" min="0" max="1" step="0.01"></label>
    </fieldset>

    <button id="addChar">캐릭터 추가</button>
    <button id="runBtn" disabled>실행</button>
  </div>

  <div class="panel">
    <h2>캐릭터 목록</h2>
    <ul id="charList"></ul>

    <h2>로그</h2>
    <div id="log"></div>
  </div>
</div>

<script>
const charListEl = document.getElementById("charList");
const logEl = document.getElementById("log");
const addCharBtn = document.getElementById("addChar");
const runBtn = document.getElementById("runBtn");

let characters = [];

const allCommands = [
  "의심한다","의심에 동의한다","부정한다","변호한다","변호에 가담한다",
  "감싼다","함께 감싼다","감사한다","반론한다","반론에 가담한다",
  "시끄러워","역할을 밝힌다","자신도 밝힌다","역할을 밝혀라",
  "과장해서 말한다","동의를 구한다","반론을 막는다","얼버무린다","반격한다",
  "도움 요청","슬퍼한다","속지마라","투표해라","투표하지 마라",
  "반드시 인간이다","반드시 적이다","전원 배제해라","잡담한다",
  "협력하자","인간이라고 말해","도게자한다"
];

function appendLog(msg) {
  logEl.textContent += msg + "\n";
  logEl.scrollTop = logEl.scrollHeight;
}

function renderCharList() {
  charListEl.innerHTML = "";
  characters.forEach(c => {
    const li = document.createElement("li");
    li.textContent = `${c.name} | ${c.gender} | ${c.age}세 | 신뢰도:${c.trust} 우호도:${c.favor} | 사용가능 커맨드: ${c.commands.join(", ")}`;
    charListEl.appendChild(li);
  });
}

addCharBtn.addEventListener("click", () => {
  const name = document.getElementById("name").value.trim();
  const gender = document.getElementById("gender").value;
  const age = Math.max(0, parseInt(document.getElementById("age").value)||0);

  const stats = {
    charisma: Math.min(Math.max(parseInt(document.getElementById("charisma").value)||0,0),50),
    logic: Math.min(Math.max(parseInt(document.getElementById("logic").value)||0,0),50),
    acting: Math.min(Math.max(parseInt(document.getElementById("acting").value)||0,0),50),
    charm: Math.min(Math.max(parseInt(document.getElementById("charm").value)||0,0),50),
    stealth: Math.min(Math.max(parseInt(document.getElementById("stealth").value)||0,0),50),
    intuition: Math.min(Math.max(parseInt(document.getElementById("intuition").value)||0,0),50)
  };

  const personality = {
    cheer: Math.min(Math.max(parseFloat(document.getElementById("cheer").value)||0,0),1),
    social: Math.min(Math.max(parseFloat(document.getElementById("social").value)||0,0),1),
    logical: Math.min(Math.max(parseFloat(document.getElementById("logical").value)||0,0),1),
    kindness: Math.min(Math.max(parseFloat(document.getElementById("kindness").value)||0,0),1),
    desire: Math.min(Math.max(parseFloat(document.getElementById("desire").value)||0,0),1),
    courage: Math.min(Math.max(parseFloat(document.getElementById("courage").value)||0,0),1)
  };

  const charData = {
    name, gender, age,
    stats,
    personality,
    commands: [...allCommands],
    trust: 50,
    favor: 50,
    aggro: 0
  };

  characters.push(charData);
  renderCharList();
  runBtn.disabled = false;
});

function executeCommand(actor, cmd) {
  const possibleTargets = characters.filter(c=>c!==actor);
  const target = possibleTargets[Math.floor(Math.random()*possibleTargets.length)];
  appendLog(`${actor.name}가 "${cmd}" 커맨드를 사용했습니다${target? ` → ${target.name}`:""}`);
}

runBtn.addEventListener("click", ()=>{
  logEl.textContent="";
  characters.forEach(c=>{
    const cmd = c.commands[Math.floor(Math.random()*c.commands.length)];
    executeCommand(c, cmd);
  });
});
</script>

</body>
</html>
